{"version":3,"file":"AbnormalReportModal.js","sources":["components/AbnormalReportModal/AbnormalReportModal.vue","/Users/yx/Documents/Vue3Projects/cycl/components/AbnormalReportModal/AbnormalReportModal.vue?type=component"],"sourcesContent":["<!-- 异常上报弹窗组件 -->\n<template>\n    <view v-if=\"show\" class=\"abnormal-mask\" @touchstart=\"preventTouch\" @touchmove=\"preventTouch\"\n        @touchend=\"preventTouch\">\n        <view class=\"abnormal-modal\">\n            <view class=\"modal-header\">\n                <text class=\"modal-title\">异常上报</text>\n                <text class=\"close-btn\" @tap=\"handleClose\">×</text>\n            </view>\n\n            <view class=\"modal-content\">\n                <view class=\"abnormal-types\">\n                    <text class=\"section-title\">请选择异常类型：</text>\n                    <view class=\"type-list\">\n                        <view v-for=\"(type, index) in abnormalTypes\" :key=\"index\" class=\"type-item\"\n                            :class=\"{ active: selectedException === type.label }\"\n                            @tap=\"selectExceptionType(type.label)\">\n                            <view class=\"radio-item\">\n                                <view class=\"radio-circle\" :class=\"{ checked: selectedException === type.label }\">\n                                    <view v-if=\"selectedException === type.label\" class=\"radio-dot\"></view>\n                                </view>\n                                <text class=\"type-text\">{{ type.label }}</text>\n                            </view>\n                        </view>\n                    </view>\n                </view>\n\n                <view class=\"other-reason\">\n                    <text class=\"section-title\">其他原因：</text>\n                    <textarea v-model=\"otherReason\" class=\"other-input\" placeholder=\"如果没有合适的选项，请在此输入具体原因...\"\n                        maxlength=\"50\" @input=\"onOtherReasonInput\"></textarea>\n                    <text class=\"char-count\">{{ otherReason.length }}/50</text>\n                </view>\n            </view>\n\n            <view class=\"modal-footer\">\n                <view class=\"btn-group\">\n                    <view class=\"cancel-btn\" @tap=\"handleClose\">\n                        取消\n                    </view>\n                    <view class=\"confirm-btn\" :class=\"{ disabled: !selectedException.trim() }\" @tap=\"handleSubmit\">\n                        确认上报\n                    </view>\n                </view>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport { apiGetnoNeedCollect } from '@/api/apis.js'\n\n// 定义组件属性\nconst props = defineProps({\n    /**\n     * 是否显示弹窗\n     */\n    show: {\n        type: Boolean,\n        default: false\n    },\n    /**\n     * 订单数据\n     */\n    orderData: {\n        type: Object,\n        default: null\n    }\n})\n\n// 定义组件事件\nconst emit = defineEmits(['close', 'success'])\n\n// 异常类型选项\nconst abnormalTypes = [\n    { label: '商家未营业', value: 'merchant_closed' },\n    { label: '垃圾桶损坏', value: 'bucket_damaged' },\n    { label: '道路不通', value: 'road_blocked' },\n    { label: '商家拒绝收运', value: 'merchant_refused' },\n    { label: '设备故障', value: 'equipment_failure' },\n    { label: '天气原因', value: 'weather_issue' }\n]\n\n// 异常上报相关变量\nconst selectedException = ref('')\nconst otherReason = ref('')\n\n// 监听弹窗显示状态，重置表单\nwatch(() => props.show, (newVal) => {\n    if (newVal) {\n        selectedException.value = ''\n        otherReason.value = ''\n    }\n})\n\n// 选择异常类型\nconst selectExceptionType = (type) => {\n    selectedException.value = type\n    otherReason.value = ''\n}\n\n// 处理其他原因输入\nconst onOtherReasonInput = () => {\n    if (otherReason.value.trim()) {\n        selectedException.value = ''\n    }\n}\n\n// 阻止遮罩层触摸事件\nconst preventTouch = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n    return false\n}\n\n// 关闭弹窗\nconst handleClose = () => {\n    emit('close')\n}\n\n// 处理异常上报提交\nconst handleSubmit = async () => {\n    if (!selectedException.value.trim() && !otherReason.value.trim()) {\n        uni.showToast({ title: '请选择异常类型或输入其他原因', icon: 'none' })\n        return\n    }\n\n    try {\n        let fullRemark = ''\n        if (selectedException.value) {\n            fullRemark = selectedException.value\n        } else {\n            fullRemark = otherReason.value\n        }\n\n        const { id: planId } = props.orderData\n        const result = await apiGetnoNeedCollect({\n            id: planId,\n            driverId: props.orderData.driverId,\n            remark: fullRemark\n        })\n\n        if (result.code === 200) {\n            uni.showToast({ title: '异常上报成功', icon: 'success' })\n            emit('success')\n            handleClose()\n        } else {\n            uni.showToast({ title: result.message || '异常上报失败', icon: 'none' })\n        }\n    } catch (error) {\n        uni.showToast({ title: '异常上报失败', icon: 'none' })\n        console.error('异常上报失败:', error)\n    }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n// 异常上报弹窗样式\n.abnormal-mask {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 9999;\n    pointer-events: auto;\n    touch-action: none;\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.abnormal-modal {\n    width: 650rpx;\n    max-height: 80vh;\n    background: #fff;\n    border-radius: 24rpx;\n    overflow: hidden;\n    box-shadow: 0 8rpx 40rpx rgba(0, 0, 0, 0.15);\n    position: relative;\n    z-index: 10000;\n\n    .modal-header {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        padding: 30rpx 30rpx 20rpx;\n        border-bottom: 1rpx solid #f5f5f5;\n        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);\n        position: relative;\n\n        .modal-title {\n            font-size: 30rpx;\n            font-weight: 600;\n            color: #2c3e50;\n            text-align: center;\n        }\n\n        .close-btn {\n            position: absolute;\n            right: 30rpx;\n            top: 50%;\n            transform: translateY(-50%);\n            width: 50rpx;\n            height: 50rpx;\n            font-size: 28rpx;\n            color: #999;\n            line-height: 50rpx;\n            text-align: center;\n            border-radius: 50%;\n            background: #f5f5f5;\n            transition: all 0.3s;\n\n            &:active {\n                background: #e9ecef;\n                transform: translateY(-50%) scale(0.95);\n            }\n        }\n    }\n\n    .modal-content {\n        max-height: 60vh;\n        padding: 30rpx;\n\n        .section-title {\n            display: block;\n            font-size: 24rpx;\n            color: #2c3e50;\n            margin-bottom: 15rpx;\n            font-weight: 600;\n        }\n\n        .abnormal-types {\n            margin-bottom: 30rpx;\n\n            .type-list {\n                display: flex;\n                flex-direction: column;\n                gap: 12rpx;\n\n                .type-item {\n                    padding: 18rpx 16rpx;\n                    border: 2rpx solid #e9ecef;\n                    border-radius: 12rpx;\n                    background: #fafbfc;\n                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n                    position: relative;\n                    overflow: hidden;\n\n                    &::before {\n                        content: '';\n                        position: absolute;\n                        top: 0;\n                        left: 0;\n                        width: 0;\n                        height: 100%;\n                        background: linear-gradient(90deg, #07C160, #4CAF50);\n                        transition: width 0.3s ease;\n                        opacity: 0.1;\n                    }\n\n                    &.active {\n                        border-color: #07C160;\n                        background: linear-gradient(135deg, #e8f5e8 0%, #f0f9f0 100%);\n                        transform: translateY(-2rpx);\n                        box-shadow: 0 4rpx 20rpx rgba(7, 193, 96, 0.15);\n\n                        &::before {\n                            width: 100%;\n                        }\n                    }\n\n                    &:active {\n                        transform: scale(0.98);\n                    }\n\n                    .radio-item {\n                        display: flex;\n                        align-items: center;\n                        gap: 16rpx;\n                        position: relative;\n                        z-index: 1;\n\n                        .radio-circle {\n                            width: 28rpx;\n                            height: 28rpx;\n                            border: 2rpx solid #ddd;\n                            border-radius: 50%;\n                            display: flex;\n                            align-items: center;\n                            justify-content: center;\n                            transition: all 0.3s ease;\n                            flex-shrink: 0;\n\n                            &.checked {\n                                border-color: #07C160;\n                                background: #07C160;\n                                transform: scale(1.1);\n                            }\n\n                            .radio-dot {\n                                width: 14rpx;\n                                height: 14rpx;\n                                background: #fff;\n                                border-radius: 50%;\n                                animation: radioDot 0.3s ease;\n                            }\n                        }\n\n                        .type-text {\n                            font-size: 26rpx;\n                            color: #2c3e50;\n                            font-weight: 500;\n                            flex: 1;\n                        }\n                    }\n                }\n            }\n        }\n\n        .other-reason {\n            .other-input {\n                width: 100%;\n                height: 100rpx;\n                padding: 16rpx;\n                border: 2rpx solid #e9ecef;\n                border-radius: 10rpx;\n                font-size: 24rpx;\n                background: #fafbfc;\n                resize: none;\n                box-sizing: border-box;\n                transition: all 0.3s ease;\n                line-height: 1.5;\n\n                &:focus {\n                    border-color: #07C160;\n                    background: #fff;\n                    box-shadow: 0 0 0 4rpx rgba(7, 193, 96, 0.1);\n                }\n            }\n\n            .char-count {\n                display: block;\n                text-align: right;\n                font-size: 20rpx;\n                color: #6c757d;\n                margin-top: 8rpx;\n            }\n        }\n    }\n\n    .modal-footer {\n        padding: 20rpx 30rpx 30rpx;\n        border-top: 1rpx solid #f5f5f5;\n        background: #fafbfc;\n\n        .btn-group {\n            display: flex;\n            gap: 16rpx;\n            justify-content: flex-end;\n\n            .cancel-btn,\n            .confirm-btn {\n                flex: 1;\n                max-width: 160rpx;\n                height: 56rpx;\n                border-radius: 28rpx;\n                font-size: 24rpx;\n                font-weight: 600;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                transition: all 0.3s ease;\n            }\n\n            .cancel-btn {\n                background: #f8f9fa;\n                color: #6c757d;\n                border: 2rpx solid #e9ecef;\n\n                &:active {\n                    background: #e9ecef;\n                    transform: scale(0.98);\n                }\n            }\n\n            .confirm-btn {\n                background: linear-gradient(135deg, #07C160, #4CAF50);\n                color: #fff;\n                border: none;\n                box-shadow: 0 4rpx 20rpx rgba(7, 193, 96, 0.3);\n\n                &:active {\n                    transform: scale(0.98);\n                    box-shadow: 0 2rpx 10rpx rgba(7, 193, 96, 0.4);\n                }\n\n                &.disabled {\n                    background: #07C160;\n                    color: #fff;\n                    box-shadow: none;\n                    transform: none;\n                }\n            }\n        }\n    }\n}\n\n@keyframes radioDot {\n    0% {\n        transform: scale(0);\n    }\n\n    50% {\n        transform: scale(1.2);\n    }\n\n    100% {\n        transform: scale(1);\n    }\n}\n</style>\n","import Component from '/Users/yx/Documents/Vue3Projects/cycl/components/AbnormalReportModal/AbnormalReportModal.vue'\nwx.createComponent(Component)"],"names":["ref","watch","uni","apiGetnoNeedCollect"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAsDA,UAAM,QAAQ;AAkBd,UAAM,OAAO;AAGb,UAAM,gBAAgB;AAAA,MAClB,EAAE,OAAO,SAAS,OAAO,kBAAmB;AAAA,MAC5C,EAAE,OAAO,SAAS,OAAO,iBAAkB;AAAA,MAC3C,EAAE,OAAO,QAAQ,OAAO,eAAgB;AAAA,MACxC,EAAE,OAAO,UAAU,OAAO,mBAAoB;AAAA,MAC9C,EAAE,OAAO,QAAQ,OAAO,oBAAqB;AAAA,MAC7C,EAAE,OAAO,QAAQ,OAAO,gBAAiB;AAAA,IAC7C;AAGA,UAAM,oBAAoBA,cAAG,IAAC,EAAE;AAChC,UAAM,cAAcA,cAAG,IAAC,EAAE;AAG1BC,kBAAK,MAAC,MAAM,MAAM,MAAM,CAAC,WAAW;AAChC,UAAI,QAAQ;AACR,0BAAkB,QAAQ;AAC1B,oBAAY,QAAQ;AAAA,MACvB;AAAA,IACL,CAAC;AAGD,UAAM,sBAAsB,CAAC,SAAS;AAClC,wBAAkB,QAAQ;AAC1B,kBAAY,QAAQ;AAAA,IACxB;AAGA,UAAM,qBAAqB,MAAM;AAC7B,UAAI,YAAY,MAAM,QAAQ;AAC1B,0BAAkB,QAAQ;AAAA,MAC7B;AAAA,IACL;AAGA,UAAM,eAAe,CAAC,MAAM;AACxB,QAAE,eAAgB;AAClB,QAAE,gBAAiB;AACnB,aAAO;AAAA,IACX;AAGA,UAAM,cAAc,MAAM;AACtB,WAAK,OAAO;AAAA,IAChB;AAGA,UAAM,eAAe,YAAY;AAC7B,UAAI,CAAC,kBAAkB,MAAM,KAAI,KAAM,CAAC,YAAY,MAAM,QAAQ;AAC9DC,sBAAG,MAAC,UAAU,EAAE,OAAO,kBAAkB,MAAM,QAAQ;AACvD;AAAA,MACH;AAED,UAAI;AACA,YAAI,aAAa;AACjB,YAAI,kBAAkB,OAAO;AACzB,uBAAa,kBAAkB;AAAA,QAC3C,OAAe;AACH,uBAAa,YAAY;AAAA,QAC5B;AAED,cAAM,EAAE,IAAI,OAAQ,IAAG,MAAM;AAC7B,cAAM,SAAS,MAAMC,6BAAoB;AAAA,UACrC,IAAI;AAAA,UACJ,UAAU,MAAM,UAAU;AAAA,UAC1B,QAAQ;AAAA,QACpB,CAAS;AAED,YAAI,OAAO,SAAS,KAAK;AACrBD,wBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,WAAW;AAClD,eAAK,SAAS;AACd,sBAAa;AAAA,QACzB,OAAe;AACHA,8BAAI,UAAU,EAAE,OAAO,OAAO,WAAW,UAAU,MAAM,QAAQ;AAAA,QACpE;AAAA,MACJ,SAAQ,OAAO;AACZA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,QAAQ;AAC/CA,sBAAAA,MAAA,MAAA,SAAA,iEAAc,WAAW,KAAK;AAAA,MACjC;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzJA,GAAG,gBAAgB,SAAS;"}