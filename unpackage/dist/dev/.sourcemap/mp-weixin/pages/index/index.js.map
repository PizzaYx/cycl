{"version":3,"file":"index.js","sources":["pages/index/index.vue","pages/index/index.vue?type=page"],"sourcesContent":["<template>\r\n\t<!-- 主登录 -->\r\n\t<view class=\"loginLayout\">\r\n\t\t<bg-image height=\"442rpx\" src=\"/static/headTopBg.png\">\r\n\t\t\t<view class=\"loginInfo\">\r\n\t\t\t\t<view class=\"logo\">\r\n\t\t\t\t\t<image src=\"/static/logo.png\" mode=\"aspectFill\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"title\">\r\n\t\t\t\t\t厨余处理小程序\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"subtitle\">\r\n\t\t\t\t\t智能收运·绿色环保\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"chooseRow\">\r\n\t\t\t\t\t<view class=\"tab-item\" :class=\"{ active: activeTab === 0 }\" @click=\"activeTab = 0\">\r\n\t\t\t\t\t\t商户端\r\n\t\t\t\t\t\t<view class=\"indicator\" v-if=\"activeTab === 0\"></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"tab-item\" :class=\"{ active: activeTab === 1 }\" @click=\"activeTab = 1\">\r\n\t\t\t\t\t\t收运端\r\n\t\t\t\t\t\t<view class=\"indicator\" v-if=\"activeTab === 1\"></view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"inputInfo\">\r\n\t\t\t\t\t<input class=\"account\" placeholder=\"请输入手机号码\" type=\"text\" placeholder-class=\"input-placeholder\"\r\n\t\t\t\t\t\tv-model=\"formData.account\" />\r\n\t\t\t\t\t<input class=\"account password\" placeholder=\"请输入密码\" type=\"safe-password\"\r\n\t\t\t\t\t\tplaceholder-class=\"input-placeholder\" v-model=\"formData.password\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"loginBtn\">\r\n\t\t\t\t\t<button type=\"button\" @click=\"handleLogin\">登录</button>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"footer\">\r\n\t\t\t\t\t<uni-icons :type=\"agreed ? 'circle-filled' : 'circle'\" size=\"24\"\r\n\t\t\t\t\t\t:color=\"agreed ? 'rgba(7, 193, 96, 1)' : 'rgba(19, 19, 19, 0.5)'\" @click=\"toggleAgreement\">\r\n\t\t\t\t\t</uni-icons>\r\n\t\t\t\t\t<view class=\"agreement-text\">\r\n\t\t\t\t\t\t<text class=\"normal-text\">我已阅读并同意</text>\r\n\t\t\t\t\t\t<text class=\"link-text\" @click=\"openAgreement('user')\">《用户协议》</text>\r\n\t\t\t\t\t\t<text class=\"normal-text\">和</text>\r\n\t\t\t\t\t\t<text class=\"link-text\" @click=\"openAgreement('privacy')\">《隐私服务》</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</bg-image>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\treactive,\r\n\t\tref\r\n} from 'vue';\r\n\r\nimport { apiPostLogin, apiGetInfo } from '@/api/apis.js';\r\n\r\n\t//商户端/收运端\r\n\tconst activeTab = ref(0);\r\n\r\n\t//是否同意\r\n\tconst agreed = ref(false)\r\n\r\n\tconst toggleAgreement = () => {\r\n\t\tagreed.value = !agreed.value\r\n\t}\r\n\r\n\t// 打开协议页面\r\n\tconst openAgreement = (type) => {\r\n\t\t// 这里可以添加跳转到协议页面的逻辑\r\n\t\tconsole.log('打开协议:', type)\r\n\t\t// 例如使用 uni.navigateTo 跳转到协议页面\r\n\t}\r\n\r\n\t// 表单数据\r\n\tconst formData = reactive({\r\n\t\taccount: '',\r\n\t\tpassword: ''\r\n\t});\r\n\r\n\t// 登录处理\r\n\tconst handleLogin = () => {\r\n\t\t// 表单验证\r\n\t\tif (!formData.account) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入手机号码',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// if (formData.account.length !== 11) {\r\n\t\t// \tuni.showToast({\r\n\t\t// \t\ttitle: '手机号码格式不正确',\r\n\t\t// \t\ticon: 'none'\r\n\t\t// \t});\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\t// if (!formData.password) {\r\n\t\t// \tuni.showToast({\r\n\t\t// \t\ttitle: '请输入密码',\r\n\t\t// \t\ticon: 'none'\r\n\t\t// \t});\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\tif (formData.password.length < 6) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '密码长度不能少于6位',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!agreed.value) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请先同意用户协议和隐私服务',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// 调用登录接口\r\n\t\tloginRequest();\r\n\t};\r\n\r\n// 登录请求\r\nconst loginRequest = async () => {\r\n    uni.showLoading({\r\n        title: '登录中...'\r\n    });\r\n\r\n    try {\r\n        // 使用封装好的API方法\r\n        const res = await apiPostLogin({\r\n            username: formData.account,\r\n            password: formData.password\r\n        });\r\n\r\n        if (res.code === 200) {\r\n            uni.showToast({\r\n                title: '登录成功',\r\n                icon: 'success'\r\n            });\r\n\r\n            await fetchUserInfo();\r\n\r\n            // 延迟跳转确保toast显示\r\n            setTimeout(() => {\r\n                uni.navigateTo({\r\n                    url: activeTab.value ? '/pages/collection/collection' : '/pages/merchant/merchant'\r\n                });\r\n            }, 1000);\r\n        } else {\r\n            uni.showToast({\r\n                title: res.msg || '登录失败',\r\n                icon: 'none'\r\n            });\r\n        }\r\n    } catch (err) {\r\n        uni.showToast({\r\n            title: '网络请求失败',\r\n            icon: 'none'\r\n        });\r\n        console.error('登录请求失败:', err);\r\n    } finally {\r\n        uni.hideLoading();\r\n    }\r\n};\r\n\r\n// 获取用户信息\r\nconst fetchUserInfo = async () => {\r\n    try {\r\n        const userInfoRes = await apiGetInfo(); // 使用你在 \r\n        if (userInfoRes.code === 200) {\r\n            // 保存用户信息到本地缓存\r\n            uni.setStorageSync('userInfo', userInfoRes.data);\r\n        } else {\r\n            console.error('获取用户信息失败:', userInfoRes.msg);\r\n        }\r\n    } catch (error) {\r\n        console.error('获取用户信息异常:', error);\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.loginLayout {\r\n\t\tposition: relative;\r\n\r\n\t\t.loginInfo {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: flex-start;\r\n\t\t\tflex-direction: column;\r\n\t\t\tpadding-top: 284rpx;\r\n\t\t\tmin-height: 100vh; // 确保容器至少占满视口高度\r\n\t\t\twidth: 100%;\r\n\r\n\t\t\t// min-height: 100vh;\r\n\t\t\t// box-sizing: border-box;\r\n\t\t\t.logo {\r\n\t\t\t\twidth: 200rpx;\r\n\t\t\t\theight: 200rpx;\r\n\r\n\t\t\t\timage {\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\theight: 100%;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.title {\r\n\t\t\t\tfont-size: 48rpx;\r\n\t\t\t\tfont-weight: 400;\r\n\t\t\t\tcolor: #131313;\r\n\t\t\t\tpadding-top: 60rpx;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t.subtitle {\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #4B4B4B;\r\n\t\t\t\tpadding-top: 32rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.chooseRow {\r\n\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tpadding-top: 52rpx;\r\n\r\n\t\t\t\t.tab-item {\r\n\t\t\t\t\tcolor: rgba(19, 19, 19, 0.50); // 未选中灰色\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\tposition: relative;\r\n\t\t\t\t\tpadding: 0 30rpx;\r\n\r\n\t\t\t\t\t&.active {\r\n\t\t\t\t\t\tcolor: rgba(19, 19, 19, 1); // 选中黑色\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.indicator {\r\n\t\t\t\t\t\twidth: 68rpx;\r\n\t\t\t\t\t\theight: 16rpx;\r\n\t\t\t\t\t\tbackground: rgba(7, 193, 96, 0.2);\r\n\t\t\t\t\t\tborder-radius: 100rpx;\r\n\t\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\t\tbottom: -5rpx;\r\n\t\t\t\t\t\tleft: 50%;\r\n\t\t\t\t\t\ttransform: translateX(-50%);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.tab-item:first-child {\r\n\t\t\t\t\tmargin-right: 108rpx; // 一半间距\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.tab-item:last-child {\r\n\t\t\t\t\tmargin-left: 108rpx; // 一半间距\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t\t.inputInfo {\r\n\t\t\t\tpadding-top: 82rpx;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: center;\r\n\r\n\t\t\t\t.account {\r\n\t\t\t\t\twidth: 608rpx;\r\n\t\t\t\t\theight: 80rpx;\r\n\t\t\t\t\tbackground: #F4F4F4;\r\n\t\t\t\t\tborder-radius: 40rpx;\r\n\t\t\t\t\tpadding: 0 30rpx;\r\n\t\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\tmargin-bottom: 40rpx;\r\n\r\n\t\t\t\t\t&:last-child {\r\n\t\t\t\t\t\tmargin-bottom: 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&.password {\r\n\t\t\t\t\t\tmargin-bottom: 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.input-placeholder {\r\n\t\t\t\t\t// font-family: PingFang SC Regular, PingFang SC Regular;\r\n\t\t\t\t\tfont-weight: 400;\r\n\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\tcolor: rgba(61, 61, 61, 0.3);\r\n\t\t\t\t\tline-height: 24rpx;\r\n\t\t\t\t\ttext-align: left;\r\n\t\t\t\t\tfont-style: normal;\r\n\t\t\t\t\ttext-transform: none;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.loginBtn {\r\n\t\t\t\tpadding-top: 66rpx;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\r\n\t\t\t\tbutton {\r\n\t\t\t\t\twidth: 608rpx;\r\n\t\t\t\t\theight: 80rpx;\r\n\t\t\t\t\tbackground: #07C160;\r\n\t\t\t\t\tborder-radius: 40rpx;\r\n\t\t\t\t\tborder: none;\r\n\t\t\t\t\tcolor: white;\r\n\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\tfont-weight: 400;\r\n\r\n\t\t\t\t\t&::after {\r\n\t\t\t\t\t\tborder: none; // 去除button默认边框\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.footer {\r\n\t\t\t\tmargin-top: auto;\r\n\t\t\t\tpadding-bottom: calc(72rpx + env(safe-area-inset-bottom));\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\twidth: 100%;\r\n\r\n\t\t\t\t.agreement-text {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tmargin-left: 10rpx;\r\n\r\n\t\t\t\t\t.normal-text {\r\n\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\tcolor: rgba(61, 61, 61, 0.50);\r\n\t\t\t\t\t\tline-height: 36rpx;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.link-text {\r\n\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\tcolor: rgba(7, 193, 96, 1);\r\n\t\t\t\t\t\tline-height: 36rpx;\r\n\t\t\t\t\t\ttext-decoration: underline;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t::v-deep .uni-icons {\r\n\t\t\t\t\tflex-shrink: 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/yx/Documents/Vue3Projects/cycl/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","reactive","apiPostLogin","apiGetInfo"],"mappings":";;;;;;;;;;;;;;;;;AA0DC,UAAM,YAAYA,kBAAI,CAAC;AAGvB,UAAM,SAASA,cAAG,IAAC,KAAK;AAExB,UAAM,kBAAkB,MAAM;AAC7B,aAAO,QAAQ,CAAC,OAAO;AAAA,IACvB;AAGD,UAAM,gBAAgB,CAAC,SAAS;AAE/BC,oBAAAA,MAAY,MAAA,OAAA,+BAAA,SAAS,IAAI;AAAA,IAEzB;AAGD,UAAM,WAAWC,cAAAA,SAAS;AAAA,MACzB,SAAS;AAAA,MACT,UAAU;AAAA,IACZ,CAAE;AAGD,UAAM,cAAc,MAAM;AAEzB,UAAI,CAAC,SAAS,SAAS;AACtBD,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD;AAAA,MACA;AAkBD,UAAI,SAAS,SAAS,SAAS,GAAG;AACjCA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD;AAAA,MACA;AAED,UAAI,CAAC,OAAO,OAAO;AAClBA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD;AAAA,MACA;AAGD;IACF;AAGA,UAAM,eAAe,YAAY;AAC7BA,oBAAAA,MAAI,YAAY;AAAA,QACZ,OAAO;AAAA,MACf,CAAK;AAED,UAAI;AAEA,cAAM,MAAM,MAAME,sBAAa;AAAA,UAC3B,UAAU,SAAS;AAAA,UACnB,UAAU,SAAS;AAAA,QAC/B,CAAS;AAED,YAAI,IAAI,SAAS,KAAK;AAClBF,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACtB,CAAa;AAED,gBAAM,cAAa;AAGnB,qBAAW,MAAM;AACbA,0BAAAA,MAAI,WAAW;AAAA,cACX,KAAK,UAAU,QAAQ,iCAAiC;AAAA,YAC5E,CAAiB;AAAA,UACJ,GAAE,GAAI;AAAA,QACnB,OAAe;AACHA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,IAAI,OAAO;AAAA,YAClB,MAAM;AAAA,UACtB,CAAa;AAAA,QACJ;AAAA,MACJ,SAAQ,KAAK;AACVA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QAClB,CAAS;AACDA,sBAAA,MAAA,MAAA,SAAA,gCAAc,WAAW,GAAG;AAAA,MACpC,UAAc;AACNA,sBAAG,MAAC,YAAW;AAAA,MAClB;AAAA,IACL;AAGA,UAAM,gBAAgB,YAAY;AAC9B,UAAI;AACA,cAAM,cAAc,MAAMG,SAAAA;AAC1B,YAAI,YAAY,SAAS,KAAK;AAE1BH,wBAAAA,MAAI,eAAe,YAAY,YAAY,IAAI;AAAA,QAC3D,OAAe;AACHA,wBAAA,MAAA,MAAA,SAAA,gCAAc,aAAa,YAAY,GAAG;AAAA,QAC7C;AAAA,MACJ,SAAQ,OAAO;AACZA,sBAAA,MAAA,MAAA,SAAA,gCAAc,aAAa,KAAK;AAAA,MACnC;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvLA,GAAG,WAAW,eAAe;"}