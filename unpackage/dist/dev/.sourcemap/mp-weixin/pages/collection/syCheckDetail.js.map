{"version":3,"file":"syCheckDetail.js","sources":["pages/collection/syCheckDetail.vue","pages/collection/syCheckDetail.vue?type=page"],"sourcesContent":["<!-- 收运详细查看 -->\r\n<template>\r\n    <view class=\"container\">\r\n        <!-- 头部导航 -->\r\n        <uni-nav-bar dark :fixed=\"true\" background-color=\"#fff\" status-bar left-icon=\"left\" color=\"#000\" title=\"收运记录\"\r\n            @clickLeft=\"back\" />\r\n\r\n        <!-- 用户信息 -->\r\n        <view class=\"user-info\">\r\n            <view class=\"name\">{{ driverName }}</view>\r\n            <view class=\"status-tag\" :class=\"statusClass\">{{ statusText }}</view>\r\n        </view>\r\n        <!-- 内容区域 -->\r\n        <view class=\"content\">\r\n\r\n            <!-- 基础信息列表 -->\r\n            <view class=\"info-list\">\r\n                <view class=\"info-item\">\r\n                    <text class=\"label\">收运时间</text>\r\n                    <text class=\"value\">{{ time }}</text>\r\n                </view>\r\n                <view class=\"info-item\">\r\n                    <text class=\"label\">商家名称</text>\r\n                    <text class=\"value\">{{ merchantName }}</text>\r\n                </view>\r\n                <view class=\"info-item\">\r\n                    <text class=\"label\">{{ status === 1 ? '收运重量' : '预估重量' }}</text>\r\n                    <text class=\"value\">{{ weight }}KG</text>\r\n                </view>\r\n                <view class=\"info-item\">\r\n                    <text class=\"label\">{{ status === 1 ? '收运桶数' : '预估桶数' }}</text>\r\n                    <text class=\"value\">{{ bucketNum }}桶</text>\r\n                </view>\r\n                <view class=\"info-item\">\r\n                    <text class=\"label\">收运地址</text>\r\n                    <text class=\"value\">{{ address }}</text>\r\n                </view>\r\n                <view class=\"info-item\">\r\n                    <text class=\"label\">车牌号</text>\r\n                    <text class=\"value\">{{ registrationNumber }}</text>\r\n                </view>\r\n            </view>\r\n\r\n            <!-- 照片区域 -->\r\n            <view class=\"photo-section\">\r\n                <text class=\"photo-title\">厨余垃圾照片</text>\r\n                <view class=\"photo-list\">\r\n                    <image v-for=\"(item, index) in img\" :key=\"index\" class=\"photo-item\"\r\n                        :src=\"item\" mode=\"aspectFill\" @click=\"previewImage(index)\" />\r\n                </view>\r\n            </view>\r\n        </view>\r\n    </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref, computed } from 'vue';\r\nimport { apiGetDriverPlanById } from '@/api/apis.js'\r\nimport { onLoad } from '@dcloudio/uni-app'; // 正确导入onLoad生命周期\r\n// 新增接收页面参数的变量\r\nconst planId = ref(''); // 车辆ID\r\nconst driverId = ref(''); // 司机ID\r\n\r\n//页面显示参数\r\nconst driverName = ref(''); //司机名称\r\nconst status = ref();//状态 0 进行中 1.已完成 2.无法收运 \r\nconst merchantName = ref('');//商家名称\r\nconst weight = ref(0.0);//重量  状态1接收weight     其他状态接收   estimateWeight\r\nconst bucketNum = ref(0);//桶数 状态1接收bucketNum 其他状态接收estimateBucketNum\r\nconst address = ref('');//地址 \r\nconst registrationNumber = ref(''); //车牌号\r\nconst img = ref([]);//照片 ,分隔的图片\r\nconst time = ref(''); // 收运时间\r\n\r\n// 根据状态显示对应的文字\r\nconst statusText = computed(() => {\r\n    switch(status.value) {\r\n        case 0: return '进行中';\r\n        case 1: return '已完成';\r\n        case 2: return '无法收运';\r\n        default: return '';\r\n    }\r\n});\r\n\r\nconst statusClass = computed(() => {\r\n    switch(status.value) {\r\n        case 0: return 'processing';\r\n        case 1: return 'completed';\r\n        case 2: return 'cancelled';\r\n        default: return '';\r\n    }\r\n});\r\n\r\nonLoad((options) => {\r\n    if (options.planId) planId.value = options.planId;\r\n    if (options.driverId) driverId.value = options.driverId;\r\n    \r\n    console.log('接收到的参数:', options);\r\n});\r\n\r\n// 页面逻辑\r\nonMounted(() => {\r\n    // 获取收运记录详情\r\n    getSyCheckDetail()\r\n})\r\n\r\n//获取商户首页数据统计\r\nconst getSyCheckDetail = async () => {\r\n    const res = await apiGetDriverPlanById({\r\n        driverId: driverId.value,\r\n        id: planId.value\r\n    })\r\n\r\n    if (res.code === 200) {\r\n        // 设置司机名称\r\n        driverName.value = res.data.driverName || '';\r\n        // 设置状态\r\n        status.value = res.data.status;\r\n        // 设置商家名称\r\n        merchantName.value = res.data.merchantName || '';\r\n        // 根据状态设置重量和桶数\r\n        if (res.data.status === 1) {\r\n            // 状态1使用实际重量和桶数\r\n            weight.value = res.data.weight || 0.0;\r\n            bucketNum.value = res.data.bucketNum || 0;\r\n        } else {\r\n            // 其他状态使用预估重量和桶数\r\n            weight.value = res.data.estimateWeight || 0.0;\r\n            bucketNum.value = res.data.estimateBucketNum || 0;\r\n        }\r\n        // 设置地址\r\n        address.value = res.data.address || '';\r\n        // 设置车牌号\r\n        registrationNumber.value = res.data.registrationNumber || '';\r\n        // 设置照片\r\n        img.value = res.data.img ? res.data.img.split(',') : [];\r\n        // 根据状态获取不同的时间字段\r\n        if (res.data.status === 1) {\r\n            // 状态1使用实际收运时间(arrivalTime)\r\n            time.value = res.data.arrivalTime || '';\r\n        } else {\r\n            // 其他状态使用预约时间(appointmentTime)\r\n            time.value = res.data.appointmentTime || '';\r\n        }\r\n    }\r\n}\r\n// 返回上一页\r\nconst back = () => {\r\n    uni.navigateBack()\r\n}\r\n\r\n// 照片预览功能\r\nconst previewImage = (index) => {\r\n    uni.previewImage({\r\n        urls: img.value,\r\n        current: index\r\n    })\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.container {\r\n    min-height: 100vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n    background-color: $bg-theme-color;\r\n    padding: 0 30rpx;\r\n}\r\n\r\n.user-info {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    padding: 30rpx;\r\n    background-color: #ffffff;\r\n    box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.05);\r\n    margin-top: 20rpx;\r\n    border-radius: 16rpx;\r\n    \r\n    .name {\r\n        font-size: 16px;\r\n        font-weight: bold;\r\n        color: #333333;\r\n    }\r\n    \r\n    .status-tag {\r\n        font-size: 12px;\r\n        width: 100rpx;\r\n        height: 40rpx;\r\n        border-radius: 8rpx;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n\r\n        &.processing {\r\n            color: rgba(0, 170, 255, 1);\r\n            background: rgba(0, 170, 255, 0.10);\r\n        }\r\n\r\n        &.completed {\r\n            color: rgba(255, 161, 0, 1);\r\n            background: rgba(255, 161, 0, 0.10);\r\n        }\r\n\r\n        &.cancelled {\r\n            color: rgba(61, 61, 61, 0.50);\r\n            background: rgba(153, 153, 153, 0.1);\r\n        }\r\n    }\r\n}\r\n\r\n.content {\r\n    padding: 32rpx 0;\r\n    position: relative;\r\n    background-color: #ffffff;\r\n    border-radius: 16rpx;\r\n    margin-top: 20rpx;\r\n    box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.05);\r\n\r\n    .info-list {\r\n        padding: 0 30rpx;\r\n\r\n        .info-item {\r\n            display: flex;\r\n            margin-bottom: 32rpx;\r\n            padding-bottom: 32rpx;\r\n            border-bottom: 1rpx solid #f0f0f0;\r\n\r\n            &:last-child {\r\n                border-bottom: none;\r\n                margin-bottom: 0;\r\n                padding-bottom: 0;\r\n            }\r\n\r\n            .label {\r\n                width: 140rpx;\r\n                font-size: 14px;\r\n                color: #999999;\r\n                flex-shrink: 0;\r\n            }\r\n\r\n            .value {\r\n                flex: 1;\r\n                font-size: 14px;\r\n                color: #333333;\r\n            }\r\n        }\r\n    }\r\n\r\n    .photo-section {\r\n        margin-top: 48rpx;\r\n        padding: 0 30rpx;\r\n\r\n        .photo-title {\r\n            font-size: 14px;\r\n            color: #999999;\r\n            margin-bottom: 24rpx;\r\n            display: block;\r\n        }\r\n\r\n        .photo-list {\r\n            display: flex;\r\n            gap: 20rpx;\r\n\r\n            .photo-item {\r\n                width: 186rpx;\r\n                height: 186rpx;\r\n                border-radius: 8rpx;\r\n                box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>","import MiniProgramPage from '/Users/yx/Documents/Vue3Projects/cycl/pages/collection/syCheckDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","onLoad","uni","onMounted","apiGetDriverPlanById"],"mappings":";;;;;;;;;;;;;;AA4DA,UAAM,SAASA,cAAAA,IAAI,EAAE;AACrB,UAAM,WAAWA,cAAAA,IAAI,EAAE;AAGvB,UAAM,aAAaA,cAAAA,IAAI,EAAE;AACzB,UAAM,SAASA,cAAG,IAAA;AAClB,UAAM,eAAeA,cAAAA,IAAI,EAAE;AAC3B,UAAM,SAASA,cAAAA,IAAI,CAAG;AACtB,UAAM,YAAYA,cAAAA,IAAI,CAAC;AACvB,UAAM,UAAUA,cAAAA,IAAI,EAAE;AACtB,UAAM,qBAAqBA,cAAAA,IAAI,EAAE;AACjC,UAAM,MAAMA,cAAAA,IAAI,CAAA,CAAE;AAClB,UAAM,OAAOA,cAAAA,IAAI,EAAE;AAGnB,UAAM,aAAaC,cAAQ,SAAC,MAAM;AAC9B,cAAO,OAAO,OAAK;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf;AAAS,iBAAO;AAAA,MACnB;AAAA,IACL,CAAC;AAED,UAAM,cAAcA,cAAQ,SAAC,MAAM;AAC/B,cAAO,OAAO,OAAK;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf,KAAK;AAAG,iBAAO;AAAA,QACf;AAAS,iBAAO;AAAA,MACnB;AAAA,IACL,CAAC;AAEDC,kBAAM,OAAC,CAAC,YAAY;AAChB,UAAI,QAAQ;AAAQ,eAAO,QAAQ,QAAQ;AAC3C,UAAI,QAAQ;AAAU,iBAAS,QAAQ,QAAQ;AAE/CC,oBAAY,MAAA,MAAA,OAAA,4CAAA,WAAW,OAAO;AAAA,IAClC,CAAC;AAGDC,kBAAAA,UAAU,MAAM;AAEZ,uBAAkB;AAAA,IACtB,CAAC;AAGD,UAAM,mBAAmB,YAAY;AACjC,YAAM,MAAM,MAAMC,8BAAqB;AAAA,QACnC,UAAU,SAAS;AAAA,QACnB,IAAI,OAAO;AAAA,MACnB,CAAK;AAED,UAAI,IAAI,SAAS,KAAK;AAElB,mBAAW,QAAQ,IAAI,KAAK,cAAc;AAE1C,eAAO,QAAQ,IAAI,KAAK;AAExB,qBAAa,QAAQ,IAAI,KAAK,gBAAgB;AAE9C,YAAI,IAAI,KAAK,WAAW,GAAG;AAEvB,iBAAO,QAAQ,IAAI,KAAK,UAAU;AAClC,oBAAU,QAAQ,IAAI,KAAK,aAAa;AAAA,QACpD,OAAe;AAEH,iBAAO,QAAQ,IAAI,KAAK,kBAAkB;AAC1C,oBAAU,QAAQ,IAAI,KAAK,qBAAqB;AAAA,QACnD;AAED,gBAAQ,QAAQ,IAAI,KAAK,WAAW;AAEpC,2BAAmB,QAAQ,IAAI,KAAK,sBAAsB;AAE1D,YAAI,QAAQ,IAAI,KAAK,MAAM,IAAI,KAAK,IAAI,MAAM,GAAG,IAAI,CAAA;AAErD,YAAI,IAAI,KAAK,WAAW,GAAG;AAEvB,eAAK,QAAQ,IAAI,KAAK,eAAe;AAAA,QACjD,OAAe;AAEH,eAAK,QAAQ,IAAI,KAAK,mBAAmB;AAAA,QAC5C;AAAA,MACJ;AAAA,IACL;AAEA,UAAM,OAAO,MAAM;AACfF,oBAAAA,MAAI,aAAc;AAAA,IACtB;AAGA,UAAM,eAAe,CAAC,UAAU;AAC5BA,oBAAAA,MAAI,aAAa;AAAA,QACb,MAAM,IAAI;AAAA,QACV,SAAS;AAAA,MACjB,CAAK;AAAA,IACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5JA,GAAG,WAAW,eAAe;"}