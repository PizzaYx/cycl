{"version":3,"file":"syReport.js","sources":["pages/collection/syReport.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29sbGVjdGlvbi9zeVJlcG9ydC52dWU"],"sourcesContent":["<!-- 收运记录 -->\r\n<template>\r\n    <view class=\"container\">\r\n\r\n        <uni-nav-bar dark :fixed=\"true\" background-color=\"#fff\" status-bar left-icon=\"left\" color=\"#000\" title=\"收运记录\"\r\n            @clickLeft=\"back\" />\r\n        <!-- 添加商店信息和扫码区域 -->\r\n        <view class=\"store-info\">\r\n            <view class=\"store-name\">商店名称</view>\r\n            <view class=\"bin-info\">\r\n                <text>垃圾桶个数: {{ ljNum }}个</text>\r\n                <uni-icons type=\"scan\" size=\"24\" color=\"#07C160\" class=\"scan-icon\" @click=\"handleScan\" />\r\n            </view>\r\n        </view>\r\n        <scroll-view class=\"content\" scroll-y>\r\n            <view class=\"record-list\">\r\n                <view v-for=\"(item, index) in records\" :key=\"index\" class=\"record-card\">\r\n                    <view class=\"input-group\">\r\n                        <view class=\"input-item\">\r\n                            <text class=\"label\"><text class=\"required\">*</text>垃圾桶数（个）</text>\r\n                            <input \r\n                                type=\"number\" \r\n                                v-model=\"item.binCount\" \r\n                                class=\"input underline-input\" \r\n                                placeholder=\"请输入垃圾桶数量\" \r\n                                :readonly=\"isInputReadOnly\" />\r\n                        </view>\r\n                        <view class=\"input-item\">\r\n                            <text class=\"label\"><text class=\"required\">*</text>厨余垃圾重量（kg）</text>\r\n                            <input \r\n                                type=\"number\" \r\n                                v-model=\"item.weight\" \r\n                                class=\"input underline-input\" \r\n                                placeholder=\"请输入垃圾重量\" \r\n                                :readonly=\"isInputReadOnly\" />\r\n                        </view>\r\n                    </view>\r\n\r\n                    <view class=\"upload-section\">\r\n                        <text class=\"label\"><text class=\"required\">*</text>厨余垃圾照片</text>\r\n                        <view class=\"upload-area\">\r\n                            <uni-file-picker \r\n                                v-model=\"item.images\" \r\n                                file-mediatype=\"image\"\r\n                                :limit=\"maxImageCount\"\r\n                                :readonly=\"isInputReadOnly\"\r\n                                @select=\"handleFileUpload\">\r\n                            </uni-file-picker>\r\n                            <text class=\"upload-tip\">最多可上传{{ maxImageCount }}张图片，每张图片不超过3M</text>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <view class=\"button-group\">\r\n                        <button class=\"btn btn-cancel\" @click=\"handleCancel(index)\">取消</button>\r\n                        <button class=\"btn btn-confirm\" @click=\"handleConfirm(index)\">确认</button>\r\n                    </view>\r\n                </view>\r\n            </view>\r\n        </scroll-view>\r\n    </view>\r\n</template>\r\n\r\n<script setup>\r\n// @ts-nocheck\r\nimport { ref } from 'vue';\r\n\r\nconst ljNum = ref(1); // 垃圾桶数量\r\nconst isInputReadOnly = ref(false); // 控制输入框是否只读\r\nconst maxImageCount = 3; // 最大上传图片数量\r\nconst maxImageSize = 3 * 1024 * 1024; // 每张图片最大大小 3M\r\n\r\n\r\nconst records = ref([\r\n    {\r\n        binCount: '',\r\n        weight: '',\r\n        images: [] // 改为数组存储多张图片\r\n    }\r\n]);\r\n\r\n// 控制输入框只读状态的函数\r\nconst setInputReadOnly = (readOnly) => {\r\n    isInputReadOnly.value = readOnly;\r\n};\r\n\r\n// 文件上传前的处理\r\nconst handleFileUpload = (event) => {\r\n    // 检查事件对象和文件对象是否存在\r\n    if (!event || !event.file) {\r\n        console.warn('文件上传事件参数不完整:', event);\r\n        return true; // 允许上传继续进行\r\n    }\r\n    \r\n    const { file, index } = event;\r\n    \r\n    // 检查文件大小\r\n    if (file.size && file.size > maxImageSize) {\r\n        uni.showToast({\r\n            title: '单张图片不能超过3M',\r\n            icon: 'none'\r\n            });\r\n        return false;\r\n    }\r\n    \r\n    return true;\r\n};\r\n\r\nconst handleScan = () => {\r\n    // @ts-ignore\r\n    uni.scanCode({\r\n        success: (res) => {\r\n            console.log('扫码结果', res);\r\n            // 扫描成功后添加一条新记录\r\n            records.value.push({\r\n                binCount: '',\r\n                weight: '',\r\n                images: []\r\n            });\r\n            // 增加垃圾桶数量\r\n            ljNum.value++;\r\n        },\r\n        fail: (err) => {\r\n            console.log('扫码失败', err);\r\n            // 即使扫描失败也添加一条新记录（模拟）\r\n            records.value.push({\r\n                binCount: '',\r\n                weight: '',\r\n                images: []\r\n            });\r\n            // 增加垃圾桶数量\r\n            ljNum.value++;\r\n        }\r\n    });\r\n};\r\n\r\nconst handleCancel = (index) => {\r\n    // 如果只有一条数据，不允许删除\r\n    if (records.value.length <= 1) {\r\n        uni.showToast({\r\n            title: '至少保留一条数据',\r\n            icon: 'none'\r\n        });\r\n        return;\r\n    }\r\n    \r\n    // 弹出确认对话框\r\n    uni.showModal({\r\n        title: '确认删除',\r\n        content: '是否确认删除当前数据？',\r\n        success: (res) => {\r\n            if (res.confirm) {\r\n                // 用户点击确定，删除当前记录\r\n                records.value.splice(index, 1);\r\n                // 减少垃圾桶数量\r\n                ljNum.value--;\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nconst handleConfirm = (index) => {\r\n    console.log('确认提交', records.value[index]);\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\npage {\r\n    height: 100%;\r\n}\r\n\r\n.container {\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    background-color: #F5F5F5;\r\n}\r\n\r\n// 添加商店信息样式\r\n.store-info {\r\n    padding: 24rpx;\r\n    background-color: #FFFFFF;\r\n    margin: 20rpx;\r\n    border-radius: 20rpx;\r\n    \r\n    .store-name {\r\n        font-size: 16px;\r\n        font-weight: 500;\r\n        color: #333333;\r\n        margin-bottom: 16rpx;\r\n    }\r\n    \r\n    .bin-info {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        font-size: 14px;\r\n        color: #666666;\r\n        \r\n        .scan-icon {\r\n            cursor: pointer;\r\n        }\r\n    }\r\n}\r\n\r\n.content {\r\n    flex: 1;\r\n    overflow: auto;\r\n    \r\n    .record-list {\r\n        padding: 24rpx;\r\n        \r\n        .record-card {\r\n            background-color: #FFFFFF;\r\n            border-radius: 16rpx;\r\n            padding: 32rpx;\r\n            margin-bottom: 24rpx;\r\n            \r\n            .input-group {\r\n                margin-bottom: 32rpx;\r\n                \r\n                .input-item {\r\n                    margin-bottom: 24rpx;\r\n                    \r\n                    &:last-child {\r\n                        margin-bottom: 0;\r\n                    }\r\n                    \r\n                    .label {\r\n                        display: block;\r\n                        font-size: 14px;\r\n                        color: #333333;\r\n                        margin-bottom: 16rpx;\r\n                        \r\n                        .required {\r\n                            color: #FF4D4F;\r\n                            margin-right: 8rpx;\r\n                        }\r\n                    }\r\n                    \r\n                    .input {\r\n                        height: 88rpx;\r\n                        background-color: #F5F5F5;\r\n                        border-radius: 8rpx;\r\n                        padding: 0 24rpx;\r\n                        font-size: 14px;\r\n                    }\r\n                    \r\n                    // 下划线样式输入框\r\n                    .underline-input {\r\n                        height: 88rpx;\r\n                        background-color: transparent;\r\n                        border: none;\r\n                        border-bottom: 1px solid #e0e0e0;\r\n                        border-radius: 0;\r\n                        padding: 0 8rpx;\r\n                        font-size: 14px;\r\n                        box-shadow: none;\r\n                        \r\n                        &:focus {\r\n                            outline: none;\r\n                            border-bottom: 1px solid #07C160;\r\n                        }\r\n                        \r\n                        // 只读状态样式\r\n                        &[readonly] {\r\n                            background-color: #f5f5f5;\r\n                            color: #999;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            .upload-section {\r\n                margin-bottom: 32rpx;\r\n                \r\n                .label {\r\n                    display: block;\r\n                    font-size: 14px;\r\n                    color: #333333;\r\n                    margin-bottom: 16rpx;\r\n                    \r\n                    .required {\r\n                        color: #FF4D4F;\r\n                        margin-right: 8rpx;\r\n                    }\r\n                }\r\n                \r\n                .upload-area {\r\n                    margin-top: 16rpx;\r\n                    \r\n                    .upload-tip {\r\n                        font-size: 12px;\r\n                        color: #999999;\r\n                        line-height: 1.5;\r\n                        margin-top: 16rpx;\r\n                    }\r\n                }\r\n            }\r\n            \r\n            .button-group {\r\n                position: relative;\r\n                height: 48rpx;\r\n                margin-top: 32rpx;\r\n                \r\n                .btn {\r\n                    position: absolute;\r\n                    right: 0;\r\n                    width: 144rpx;\r\n                    height: 48rpx;\r\n                    line-height: 48rpx;\r\n                    text-align: center;\r\n                    border-radius: 100rpx;\r\n                    font-size: 14px;\r\n                    \r\n                    &.btn-cancel {\r\n                        right: 164rpx; /* 144rpx宽度 + 20rpx间距 */\r\n                        background-color: #F5F5F5;\r\n                        color: #666666;\r\n                    }\r\n                    \r\n                    &.btn-confirm {\r\n                        right: 0;\r\n                        background-color: #07C160;\r\n                        color: #FFFFFF;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>","import MiniProgramPage from 'E:/Vue3Project/cycl/pages/collection/syReport.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni"],"mappings":";;;;;;;;;;;;;;AAoEA,MAAM,gBAAgB;AACtB,MAAM,eAAe,IAAI,OAAO;;;;AAHhC,UAAM,QAAQA,cAAAA,IAAI,CAAC;AACnB,UAAM,kBAAkBA,cAAAA,IAAI,KAAK;AAKjC,UAAM,UAAUA,cAAAA,IAAI;AAAA,MAChB;AAAA,QACI,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,QAAQ,CAAE;AAAA;AAAA,MACb;AAAA,IACL,CAAC;AAQD,UAAM,mBAAmB,CAAC,UAAU;AAEhC,UAAI,CAAC,SAAS,CAAC,MAAM,MAAM;AACvBC,sBAAA,MAAA,MAAA,QAAA,uCAAa,gBAAgB,KAAK;AAClC,eAAO;AAAA,MACV;AAED,YAAM,EAAE,MAAM,MAAO,IAAG;AAGxB,UAAI,KAAK,QAAQ,KAAK,OAAO,cAAc;AACvCA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QAClB,CAAa;AACL,eAAO;AAAA,MACV;AAED,aAAO;AAAA,IACX;AAEA,UAAM,aAAa,MAAM;AAErBA,oBAAAA,MAAI,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AACdA,wBAAA,MAAA,MAAA,OAAA,wCAAY,QAAQ,GAAG;AAEvB,kBAAQ,MAAM,KAAK;AAAA,YACf,UAAU;AAAA,YACV,QAAQ;AAAA,YACR,QAAQ,CAAE;AAAA,UAC1B,CAAa;AAED,gBAAM;AAAA,QACT;AAAA,QACD,MAAM,CAAC,QAAQ;AACXA,wBAAA,MAAA,MAAA,OAAA,wCAAY,QAAQ,GAAG;AAEvB,kBAAQ,MAAM,KAAK;AAAA,YACf,UAAU;AAAA,YACV,QAAQ;AAAA,YACR,QAAQ,CAAE;AAAA,UAC1B,CAAa;AAED,gBAAM;AAAA,QACT;AAAA,MACT,CAAK;AAAA,IACL;AAEA,UAAM,eAAe,CAAC,UAAU;AAE5B,UAAI,QAAQ,MAAM,UAAU,GAAG;AAC3BA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QAClB,CAAS;AACD;AAAA,MACH;AAGDA,oBAAAA,MAAI,UAAU;AAAA,QACV,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AACd,cAAI,IAAI,SAAS;AAEb,oBAAQ,MAAM,OAAO,OAAO,CAAC;AAE7B,kBAAM;AAAA,UACT;AAAA,QACJ;AAAA,MACT,CAAK;AAAA,IACL;AAEA,UAAM,gBAAgB,CAAC,UAAU;AAC7BA,0BAAA,MAAA,OAAA,wCAAY,QAAQ,QAAQ,MAAM,KAAK,CAAC;AAAA,IAC5C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjKA,GAAG,WAAW,eAAe;"}