{"version":3,"file":"collection.js","sources":["pages/collection/collection.vue","pages/collection/collection.vue?type=page"],"sourcesContent":["<!-- 收运端首页 -->\r\n<template>\r\n    <view class=\"layout\">\r\n\r\n        <scroll-view scroll-y refresher-enabled :refresher-triggered=\"refreshing\" @refresherrefresh=\"onRefresh\"\r\n            class=\"scroll-view\">\r\n            <view class=\"headImage\">\r\n                <image src=\"/static/headTopBg.png\" mode=\"aspectFill\"></image>\r\n            </view>\r\n\r\n            <view class=\"header\" @tap=\"getUserInfo\">\r\n                <view class=\"avatar\">\r\n                    <view class=\"avatar-text\">{{ userStore.userSFAvatar }}</view>\r\n                </view>\r\n                <view class=\"info\">\r\n                    <view class=\"name\">{{ userStore.nickName || '未登录' }}</view>\r\n                    <view class=\"sub-name\">{{ userStore.sfmerchant?.registrationNumber || '未设置车牌' }}</view>\r\n                    <view class=\"auth-tag\">工作中</view>\r\n                </view>\r\n                <uni-icons type=\"right\" size=\"35rpx\"></uni-icons>\r\n            </view>\r\n\r\n            <!-- 数据统计 -->\r\n            <view class=\"statistics\">\r\n\r\n                <view class=\"stat-item\">\r\n                    <view class=\"number\">{{ syNum }} 个</view>\r\n                    <view class=\"label\">未收运商家</view>\r\n                </view>\r\n                <view class=\"stat-item\">\r\n                    <view class=\"number green\">{{ yyNum }}kg</view>\r\n                    <view class=\"label\">已收运总量</view>\r\n                </view>\r\n                <view class=\"stat-item\">\r\n                    <view class=\"number\">{{ dqNum }} 个</view>\r\n                    <view class=\"label\">已收运商家</view>\r\n                </view>\r\n                <!-- 上半圆弧形进度条 -->\r\n                <view class=\"progress-arc\">\r\n                    <canvas type=\"2d\" id=\"progressArc\" class=\"arc-canvas\" style=\"width: 100%; height: 100%;\"></canvas>\r\n                </view>\r\n            </view>\r\n\r\n            <!-- 快捷操作 -->\r\n            <view class=\"section-title\">快捷操作</view>\r\n            <view class=\"quick-actions\">\r\n                <view v-for=\"(action, index) in quickActions\" :key=\"action.id\" class=\"action-item\"\r\n                    @tap=\"handleQuickAction(action)\">\r\n                    <image :src=\"action.icon\" mode=\"aspectFill\"></image>\r\n                    <text>{{ action.name }}</text>\r\n                </view>\r\n            </view>\r\n\r\n            <!-- 收运记录 -->\r\n            <view class=\"records-header\">\r\n                <text class=\"title\">收运明细</text>\r\n                <view class=\"more\" @tap=\"goToSydAllList\">\r\n                    <text>更多</text>\r\n                    <uni-icons type=\"right\" size=\"16\" color=\"rgba(19, 19, 19, 0.50)\"></uni-icons>\r\n                </view>\r\n\r\n            </view>\r\n            <view class=\"records\">\r\n                <view class=\"order-list\" v-if=\"allOrderList.length > 0\">\r\n                    <view class=\"order-item\" v-for=\"(item, index) in allOrderList\" :key=\"index\">\r\n                        <view class=\"order-header\">\r\n                            <view class=\"shop-info\">\r\n                                <text class=\"shop-name\">{{ item.merchantName }}</text>\r\n                                <DriverStatusTag :status=\"item.status\" />\r\n                            </view>\r\n                        </view>\r\n                        <view class=\"order-content\">\r\n                            <InfoDisplay :fields=\"getInfoFields(item)\" />\r\n                        </view>\r\n                        <DriverOrderActions :status=\"item.status\" :order-data=\"item\" @refresh=\"handleRefresh\"\r\n                            @abnormalReport=\"handleAbnormalReport\" />\r\n                    </view>\r\n                </view>\r\n            </view>\r\n        </scroll-view>\r\n\r\n        <!-- 异常上报弹窗 -->\r\n        <AbnormalReportModal :show=\"showAbnormalModal\" :order-data=\"currentOrderData\" @close=\"closeAbnormalModal\"\r\n            @success=\"handleAbnormalSuccess\" />\r\n    </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed, watch, nextTick } from 'vue'\r\nimport { useUserStore } from '@/stores/user.js'\r\nimport { apiGetDriverTodayStatistics, apiGetDriverPlanPage, apiGetdriverConfirmPlan, apiGetnoNeedCollect } from '@/api/apis.js'\r\nimport { onShow } from '@dcloudio/uni-app' // 导入onShow生命周期\r\nimport InfoDisplay from '@/components/InfoDisplay/InfoDisplay.vue'\r\nimport DriverStatusTag from '@/components/DriverStatusTag/DriverStatusTag.vue'\r\nimport DriverOrderActions from '@/components/DriverOrderActions/DriverOrderActions.vue'\r\nimport AbnormalReportModal from '@/components/AbnormalReportModal/AbnormalReportModal.vue'\r\n\r\n\r\n// 使用用户 store\r\nconst userStore = useUserStore()\r\n\r\nconst yyNum = ref(0) // 已收运总量\r\nconst syNum = ref(0) // 未收运\r\nconst dqNum = ref(0) // 已收运\r\n\r\n// 计算进度百分比\r\nconst progressPercentage = computed(() => {\r\n\r\n    const total = dqNum.value + syNum.value\r\n    if (total === 0) return 0\r\n    return Math.round((dqNum.value / total) * 100)\r\n})\r\n\r\nconst allOrderList = ref([]); // 收运明细列表\r\n\r\n// 下拉刷新状态\r\nconst refreshing = ref(false)\r\n\r\n// 异常上报相关变量\r\nconst showAbnormalModal = ref(false)\r\nconst currentOrderData = ref(null)\r\n\r\n// 监听进度百分比变化，自动重绘canvas\r\nwatch(progressPercentage, () => {\r\n    nextTick(() => {\r\n        drawProgressArc()\r\n    })\r\n}, { immediate: false })\r\n\r\n\r\nonShow(async () => {\r\n    await userStore.fetchUserInfo()\r\n    await getMerchantStatistics()\r\n    await getMerchantSydList()\r\n    // 数据加载完成后再绘制canvas\r\n    drawProgressArc()\r\n\r\n})\r\n\r\n\r\n//获取商户首页数据统计\r\nconst getMerchantStatistics = async () => {\r\n    const res = await apiGetDriverTodayStatistics({\r\n        driverId: userStore.sfmerchant?.id\r\n    })\r\n\r\n    if (res.code === 200) {\r\n        dqNum.value = res.data.confirmNum;\r\n        yyNum.value = res.data.weightNum;\r\n        syNum.value = res.data.notConfirmNum;\r\n    }\r\n}\r\n\r\n\r\n// 根据状态获取信息字段\r\nconst getInfoFields = (item) => {\r\n    const status = item.status;\r\n\r\n    // 状态为 0（进行中）或 2（无法收运）时显示预估信息\r\n    if (status === 0 || status === '0' || status === 2 || status === '2') {\r\n        return [\r\n            {\r\n                key: 'appointmentTime',\r\n                label: '预估时间',\r\n                value: item.appointmentTime\r\n            },\r\n            {\r\n                key: 'estimateWeight',\r\n                label: '预估重量',\r\n                value: item.estimateWeight\r\n            },\r\n            {\r\n                key: 'estimateBucketNum',\r\n                label: '预估桶数',\r\n                value: item.estimateBucketNum\r\n            }\r\n        ];\r\n    }\r\n\r\n    // 状态为 1（已完成）时显示收运信息\r\n    if (status === 1 || status === '1') {\r\n        return [\r\n            {\r\n                key: 'arrivalTime',\r\n                label: '收运时间',\r\n                value: item.arrivalTime\r\n            },\r\n            {\r\n                key: 'weight',\r\n                label: '收运重量',\r\n                value: item.weight\r\n            },\r\n            {\r\n                key: 'bucketNum',\r\n                label: '收运桶数',\r\n                value: item.bucketNum\r\n            }\r\n        ];\r\n    }\r\n\r\n    // 默认返回预估信息\r\n    return [\r\n        {\r\n            key: 'appointmentTime',\r\n            label: '预估时间',\r\n            value: item.appointmentTime\r\n        },\r\n        {\r\n            key: 'estimateWeight',\r\n            label: '预估重量',\r\n            value: item.estimateWeight\r\n        },\r\n        {\r\n            key: 'estimateBucketNum',\r\n            label: '预估桶数',\r\n            value: item.estimateBucketNum\r\n        }\r\n    ];\r\n};\r\n\r\n\r\n//获取收运端首页收运记录显示前5条\r\nconst getMerchantSydList = async () => {\r\n    const res = await apiGetDriverPlanPage({\r\n        pageNum: 1,\r\n        pageSize: 5,\r\n        driverId: userStore.sfmerchant?.id,\r\n    })\r\n    if (res.code === 200) {\r\n        allOrderList.value = res.data.list;\r\n\r\n    } else {\r\n        // console.error('收运端首页收运明细失败', res.msg)\r\n    }\r\n}\r\n\r\nconst getUserInfo = () => {\r\n    // 检查用户认证状态并执行相应操作\r\n    // 已认证，跳转到用户页面\r\n    uni.navigateTo({\r\n        url: '/pages/user/user'\r\n    })\r\n\r\n}\r\n\r\n// 快捷操作配置\r\nconst quickActions = ref([\r\n    {\r\n        id: 'appointment',\r\n        name: '今日收运',\r\n        icon: '/static/ssd/syleft.png',\r\n        url: '/pages/collection/sfDetails' // 今日详情\r\n    },\r\n    {\r\n        id: 'records',\r\n        name: '工单统计',\r\n        icon: '/static/ssd/sydright.png',\r\n        url: '/pages/collection/syStatistics' // 统计页面\r\n    },\r\n])\r\n\r\n// 统一的快捷操作跳转处理\r\nconst handleQuickAction = (action) => {\r\n    console\r\n    // 检查页面是否存在（可以根据实际情况调整）\r\n    if (action.url) {\r\n        uni.navigateTo({\r\n            url: action.url,\r\n            fail: (err) => {\r\n                console.error('页面跳转失败:', err)\r\n                uni.showToast({\r\n                    title: '页面暂未开放',\r\n                    icon: 'none'\r\n                })\r\n            }\r\n        })\r\n    } else {\r\n        uni.showToast({\r\n            title: '功能开发中',\r\n            icon: 'none'\r\n        })\r\n    }\r\n}\r\n\r\n\r\n// 下拉刷新处理\r\nconst onRefresh = async () => {\r\n    refreshing.value = true\r\n    try {\r\n        // 重新获取用户信息\r\n        await userStore.fetchUserInfo()\r\n        await getMerchantStatistics()\r\n        await getMerchantSydList()\r\n        drawProgressArc()\r\n    } catch (error) {\r\n        console.error('刷新失败:', error)\r\n        uni.showToast({\r\n            title: '刷新失败',\r\n            icon: 'none'\r\n        })\r\n    } finally {\r\n        refreshing.value = false\r\n    }\r\n}\r\n\r\n// 处理异常上报后的刷新\r\nconst handleRefresh = async () => {\r\n    try {\r\n        // 重新获取统计数据\r\n        await getMerchantStatistics()\r\n        // 重新获取收运列表\r\n        await getMerchantSydList()\r\n        // 数据更新后重新绘制canvas\r\n        drawProgressArc()\r\n    } catch (error) {\r\n        console.error('刷新数据失败:', error)\r\n    }\r\n}\r\n\r\n// 处理异常上报事件\r\nconst handleAbnormalReport = (orderData) => {\r\n    currentOrderData.value = orderData\r\n    showAbnormalModal.value = true\r\n}\r\n\r\n// 关闭异常上报弹窗\r\nconst closeAbnormalModal = () => {\r\n    showAbnormalModal.value = false\r\n    currentOrderData.value = null\r\n}\r\n\r\n// 异常上报成功回调\r\nconst handleAbnormalSuccess = async () => {\r\n    // 刷新数据\r\n    await handleRefresh()\r\n}\r\n\r\n\r\n// 跳转到收运明细页面\r\nconst goToSydAllList = () => {\r\n    uni.navigateTo({\r\n        url: '/pages/collection/sfsyRecord'\r\n    })\r\n}\r\n\r\n// 绘制进度弧形 - 使用Canvas 2D API\r\nconst drawProgressArc = () => {\r\n    const query = uni.createSelectorQuery()\r\n    query.select('#progressArc')\r\n        .fields({ node: true, size: true })\r\n        .exec((res) => {\r\n            if (res[0]) {\r\n                const canvas = res[0].node\r\n                const ctx = canvas.getContext('2d')\r\n\r\n                const dpr = uni.getSystemInfoSync().pixelRatio\r\n                const width = res[0].width\r\n                const height = res[0].height\r\n\r\n                canvas.width = width * dpr\r\n                canvas.height = height * dpr\r\n                ctx.scale(dpr, dpr)\r\n\r\n                const centerX = width / 2  // 圆心在中央\r\n                const centerY = height * 0.73 // 圆心在canvas上方\r\n                const radius = Math.min(width, height) / 2  // 半径调整，让弧形更合适\r\n\r\n                // 清除画布\r\n                ctx.clearRect(0, 0, width, height)\r\n\r\n                // 绘制底色弧形（完整弧形）\r\n                ctx.beginPath()\r\n                ctx.arc(centerX, centerY, radius, Math.PI, 0, false)\r\n                ctx.strokeStyle = 'rgba(7, 193, 96, 0.10)'\r\n                ctx.lineWidth = 10\r\n                ctx.lineCap = 'round'\r\n                ctx.stroke()\r\n\r\n                // 绘制进度弧形（根据百分比）\r\n                const progressAngle = Math.PI * (progressPercentage.value / 100)\r\n\r\n                if (progressPercentage.value > 0) {\r\n                    ctx.beginPath()\r\n                    ctx.arc(centerX, centerY, radius, Math.PI, Math.PI + progressAngle, false)\r\n                    ctx.strokeStyle = 'rgba(7, 193, 96, 1)'\r\n                    ctx.lineWidth = 10\r\n                    ctx.lineCap = 'round'\r\n                    ctx.stroke()\r\n\r\n                    // 绘制进度弧形终点圆点\r\n                    const endAngle = Math.PI + progressAngle\r\n                    const endX = centerX + radius * Math.cos(endAngle)\r\n                    const endY = centerY + radius * Math.sin(endAngle)\r\n                    ctx.beginPath()\r\n                    ctx.arc(endX, endY, 10, 0, 2 * Math.PI, false)\r\n                    ctx.fillStyle = 'rgba(7, 193, 96, 1)'\r\n                    ctx.fill()\r\n                }\r\n            } else {\r\n                // 如果获取不到尺寸，延迟重试\r\n                setTimeout(() => {\r\n                    drawProgressArc()\r\n                }, 100)\r\n            }\r\n        })\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.layout {\r\n    position: relative;\r\n    min-height: 100vh;\r\n    background-color: $bg-theme-color;\r\n\r\n    .scroll-view {\r\n        height: 100vh;\r\n    }\r\n\r\n    .headImage {\r\n        position: absolute;\r\n        /* 绝对定位 */\r\n        top: 0;\r\n        left: 0;\r\n        z-index: 0;\r\n        /* 置于其他元素下方 */\r\n        width: 100%;\r\n        height: 442rpx;\r\n        overflow: hidden;\r\n\r\n        /* 防止内容溢出 */\r\n        image {\r\n            width: 100%;\r\n            height: 100%;\r\n            object-fit: cover;\r\n        }\r\n    }\r\n\r\n    .header {\r\n        position: relative;\r\n        padding: 214rpx 30rpx 26rpx;\r\n        width: 100%;\r\n        display: flex;\r\n        align-items: center;\r\n\r\n        .avatar {\r\n            width: 120rpx;\r\n            height: 120rpx;\r\n            margin-right: 24rpx;\r\n            background-color: rgba(7, 193, 96, 1);\r\n            border-radius: 60rpx;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n\r\n            .avatar-text {\r\n                font-size: 48rpx;\r\n                font-weight: 500;\r\n                color: #fff;\r\n            }\r\n\r\n            image {\r\n                width: 100%;\r\n                height: 100%;\r\n                border-radius: 60rpx;\r\n            }\r\n        }\r\n\r\n        .info {\r\n            flex: 1;\r\n            /* 占满剩余宽度 */\r\n            height: 120rpx;\r\n            /* 或 min-height: 120rpx; 与头像同高 */\r\n            display: flex;\r\n            flex-direction: column;\r\n            justify-content: space-around;\r\n\r\n            .name {\r\n                font-weight: 600;\r\n                font-size: 32rpx;\r\n                color: black;\r\n                line-height: 32rpx;\r\n            }\r\n\r\n            .sub-name {\r\n                font-weight: 400;\r\n                font-size: 24rpx;\r\n                color: #131313;\r\n            }\r\n\r\n            .auth-tag {\r\n                width: 120rpx;\r\n                height: 40rpx;\r\n\r\n                font-size: 22rpx;\r\n                border-radius: 10px;\r\n                display: inline-flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                background-color: rgba(7, 193, 96, 1); // 绿色 \r\n                color: #fff;\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    .statistics {\r\n        position: relative;\r\n        height: 280rpx;\r\n        display: flex;\r\n        justify-content: space-around;\r\n        background-color: #fff;\r\n        border-radius: 20rpx;\r\n        margin: 0 30rpx 30rpx;\r\n        align-items: center;\r\n        padding: 0 28rpx;\r\n        gap: 80rpx;\r\n        z-index: 1;\r\n        overflow: hidden;\r\n        transform: translateZ(0);\r\n\r\n        .stat-item {\r\n            position: relative;\r\n            height: 100%;\r\n            flex: 1;\r\n            display: flex;\r\n            flex-direction: column;\r\n            justify-content: flex-end;\r\n            text-align: center;\r\n            padding: 0 0rpx 65rpx;\r\n            z-index: 2;\r\n\r\n            .number {\r\n                font-size: 32rpx;\r\n                font-weight: 500;\r\n                color: rgba(61, 61, 61, 1);\r\n                margin-bottom: 8rpx;\r\n\r\n                &.green {\r\n                    color: #07C160;\r\n                }\r\n            }\r\n\r\n            .label {\r\n                font-size: 24rpx;\r\n                color: rgba(61, 61, 61, 1);\r\n            }\r\n        }\r\n\r\n        .progress-arc {\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            pointer-events: none;\r\n            z-index: 0;\r\n            overflow: hidden;\r\n\r\n            .arc-canvas {\r\n                width: 100%;\r\n                height: 100%;\r\n                display: block;\r\n                background: transparent;\r\n            }\r\n        }\r\n    }\r\n\r\n    .section-title {\r\n        padding: 10rpx 30rpx;\r\n        font-size: 28rpx;\r\n        font-weight: 400;\r\n        margin-bottom: 10rpx;\r\n        color: rgba(19, 19, 19, 1);\r\n    }\r\n\r\n\r\n    .quick-actions {\r\n        position: relative;\r\n        height: 120rpx;\r\n        display: flex;\r\n        justify-content: space-around;\r\n        align-items: center;\r\n        padding: 0 20rpx;\r\n\r\n        .action-item {\r\n            display: flex;\r\n            flex-direction: row;\r\n            align-items: center;\r\n            justify-content: center;\r\n            border-radius: 20rpx;\r\n\r\n            width: 336rpx;\r\n            height: 120rpx;\r\n            background-color: #fff;\r\n\r\n            image {\r\n                width: 96rpx;\r\n                height: 96rpx;\r\n                border-radius: 16rpx;\r\n            }\r\n\r\n            text {\r\n                font-size: 26rpx;\r\n                color: rgba(61, 61, 61, 1);\r\n                text-align: center;\r\n            }\r\n        }\r\n    }\r\n\r\n    .records-header {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        padding: 10rpx 30rpx;\r\n        margin-bottom: 10rpx;\r\n        margin-top: 10rpx;\r\n\r\n        .title {\r\n            font-size: 28rpx;\r\n            font-weight: 400;\r\n            color: rgba(19, 19, 19, 1);\r\n        }\r\n\r\n        .more {\r\n            font-size: 26rpx;\r\n            font-weight: 400;\r\n            color: rgba(19, 19, 19, 0.50);\r\n            display: flex;\r\n            align-items: center;\r\n            gap: 8rpx;\r\n\r\n            text {\r\n                line-height: 1.2;\r\n                display: flex;\r\n                align-items: center;\r\n            }\r\n\r\n\r\n        }\r\n    }\r\n\r\n    .records {\r\n        position: relative;\r\n        z-index: 1;\r\n        background-color: $bg-theme-color;\r\n        border-radius: 16rpx;\r\n        margin: 0 0 30rpx;\r\n\r\n        .order-list {\r\n            padding: 0 30rpx; // 左右30rpx\r\n\r\n            .order-item {\r\n                margin-bottom: 20rpx;\r\n                padding: 30rpx;\r\n                background-color: #ffffff;\r\n                border-radius: 12rpx;\r\n\r\n                .order-header {\r\n                    margin-bottom: 20rpx;\r\n\r\n                    .shop-info {\r\n                        display: flex;\r\n                        align-items: center;\r\n                        justify-content: space-between;\r\n                        margin-bottom: 16rpx;\r\n\r\n                        .shop-name {\r\n                            font-size: 28rpx;\r\n                            font-weight: 400;\r\n                            color: rgba(61, 61, 61, 1);\r\n                        }\r\n\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    // 认证弹窗样式\r\n    .auth-modal {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        background-color: rgba(0, 0, 0, 0.5);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        z-index: 9999;\r\n\r\n        .auth-modal-content {\r\n            position: relative;\r\n            width: 600rpx;\r\n            height: 700rpx;\r\n            border-radius: 24rpx;\r\n            overflow: hidden;\r\n\r\n            .auth-modal-bg {\r\n                position: absolute;\r\n                top: 0;\r\n                left: 0;\r\n                width: 634rpx;\r\n                height: 608rpx;\r\n                z-index: 1;\r\n\r\n                image {\r\n                    width: 100%;\r\n                    height: 100%;\r\n                    object-fit: cover;\r\n                }\r\n            }\r\n\r\n            .auth-modal-body {\r\n                position: relative;\r\n                z-index: 2;\r\n                height: 100%;\r\n                display: flex;\r\n                flex-direction: column;\r\n                align-items: center;\r\n                justify-content: start;\r\n\r\n                .auth-icon {\r\n                    width: 296rpx;\r\n                    height: 298rpx;\r\n                    margin: 25rpx 0;\r\n\r\n                    image {\r\n                        width: 100%;\r\n                        height: 100%;\r\n                        object-fit: contain;\r\n                    }\r\n                }\r\n\r\n                .auth-title {\r\n                    font-size: 34rpx;\r\n                    font-weight: 500;\r\n                    color: rgba(61, 61, 61, 1);\r\n                    margin-bottom: 25rpx;\r\n                    text-align: center;\r\n                }\r\n\r\n                .auth-desc {\r\n                    font-size: 28rpx;\r\n                    color: rgba(61, 61, 61, 0.50);\r\n                    text-align: center;\r\n                    margin-bottom: 35rpx;\r\n                }\r\n\r\n                .auth-button {\r\n                    width: 322rpx;\r\n                    height: 80rpx;\r\n                    background: linear-gradient(135deg, #07C160 0%, #05A64F 100%);\r\n                    border-radius: 40rpx;\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    color: #fff;\r\n                    font-size: 32rpx;\r\n                    box-shadow: 0 8rpx 20rpx rgba(7, 193, 96, 0.3);\r\n\r\n                    &:active {\r\n                        transform: scale(0.95);\r\n                        transition: transform 0.1s;\r\n                    }\r\n                }\r\n            }\r\n\r\n            .close-btn {\r\n                position: absolute;\r\n                bottom: 0rpx;\r\n                left: 50%;\r\n                transform: translateX(-50%);\r\n                width: 60rpx;\r\n                height: 60rpx;\r\n                background-color: rgba(255, 255, 255, 0.9);\r\n                border-radius: 30rpx;\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                z-index: 3;\r\n\r\n                .close-icon {\r\n                    font-size: 40rpx;\r\n                    color: #999;\r\n                    line-height: 1;\r\n                }\r\n\r\n                &:active {\r\n                    background-color: rgba(255, 255, 255, 0.7);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>","import MiniProgramPage from '/Users/yx/Documents/Vue3Projects/cycl/pages/collection/collection.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","ref","computed","watch","nextTick","onShow","apiGetDriverTodayStatistics","apiGetDriverPlanPage","uni"],"mappings":"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"}