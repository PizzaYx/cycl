{"version":3,"file":"shSignature.js","sources":["pages/syContract/shSignature.vue","pages/syContract/shSignature.vue?type=page"],"sourcesContent":["<template>\n    <view class=\"signature-container\">\n        <uni-nav-bar dark :fixed=\"true\" background-color=\"#fff\" status-bar left-icon=\"left\" color=\"#000\"\n            :title=\"contractTitle\" @clickLeft=\"back\" />\n        <!-- 横屏签名弹窗 -->\n        <view class=\"signature-modal-native\">\n            <view style=\"width: 100%; height: 100%;\">\n                <l-signature ref=\"signatureRef\" :penColor=\"penColor\" :penSize=\"penSize\" :openSmooth=\"openSmooth\"\n                    openSmooth></l-signature>\n            </view>\n\n            <view class=\"signature-buttons-rotated\">\n                <button class=\"signature-btn clear-btn\" @click=\"clearSignature\">清空</button>\n                <button class=\"signature-btn undo-btn\" @click=\"undoSignature\">撤销</button>\n                <button class=\"signature-btn save-btn\" @click=\"saveSignature\">保存签名</button>\n                <button class=\"signature-btn cancel-btn\" @click=\"cancelSignature\">取消</button>\n            </view>\n        </view>\n    </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { onLoad, onUnload } from '@dcloudio/uni-app'\n\n// 页面参数\nconst contractId = ref('')\nconst contractTitle = ref('合同签名')\n\n// 签名相关数据\nconst penColor = ref('black')\nconst penSize = ref(3)\nconst openSmooth = ref(true)\nconst signatureRef = ref(null)\n\n// 页面加载\nonLoad((options) => {\n    contractId.value = options.contractId || ''\n    contractTitle.value = options.title || '合同签名'\n})\n\n// 页面卸载时清理\nonUnload(() => {\n    // 清理工作\n    console.log('签名页面卸载')\n})\n\n// 清空签名\nconst clearSignature = () => {\n    if (signatureRef.value) {\n        try {\n            signatureRef.value.clear()\n        } catch (error) {\n            console.warn('清空签名失败:', error)\n        }\n    }\n}\n\n// 撤销签名\nconst undoSignature = () => {\n    if (signatureRef.value) {\n        try {\n            signatureRef.value.undo()\n        } catch (error) {\n            console.warn('撤销签名失败:', error)\n        }\n    }\n}\n\n// 保存签名\nconst saveSignature = () => {\n    if (!signatureRef.value) {\n        uni.showToast({\n            title: '签名组件未加载',\n            icon: 'none'\n        })\n        return\n    }\n\n    signatureRef.value.canvasToTempFilePath({\n        success: (res) => {\n            if (res.isEmpty) {\n                uni.showToast({\n                    title: '请先进行签名',\n                    icon: 'none'\n                })\n                return\n            }\n\n            uni.showToast({\n                title: '签名保存成功',\n                icon: 'success'\n            })\n\n            // 返回上一页并传递签名数据\n            setTimeout(() => {\n                uni.navigateBack({\n                    delta: 1,\n                    success: () => {\n                        // 通过事件传递签名数据\n                        uni.$emit('signatureUpdated', {\n                            partyB: res.tempFilePath\n                        })\n                    }\n                })\n            }, 1500)\n        },\n        fail: (error) => {\n            console.error('保存签名失败:', error)\n            uni.showToast({\n                title: '保存签名失败',\n                icon: 'none'\n            })\n        }\n    })\n}\n\n// 取消签名\nconst cancelSignature = () => {\n    uni.showModal({\n        title: '确认取消',\n        content: '确定要取消签名吗？',\n        success: (res) => {\n            if (res.confirm) {\n                uni.navigateBack()\n            }\n        }\n    })\n}\n\n// 返回上一页\nconst back = () => {\n    uni.navigateBack()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.signature-container {\n    width: 100vw;\n    height: 100vh;\n    background: #f5f5f5;\n}\n\n.signature-modal-native {\n    width: 100vw;\n    height: 100vh;\n    background: #fff;\n    border-radius: 0;\n    overflow: hidden;\n    position: fixed;\n    z-index: 2;\n    top: 0;\n    left: 0;\n\n    .signature-buttons-rotated {\n        position: absolute;\n        right: 20rpx;\n        top: 50%;\n        transform: translateY(-50%);\n        display: flex;\n        flex-direction: column;\n        gap: 15rpx;\n        z-index: 10;\n        background: rgba(255, 255, 255, 0.9);\n        padding: 10rpx;\n        border-radius: 8rpx;\n\n        .signature-btn {\n            height: 25rpx;\n            width: 70rpx;\n            border-radius: 30rpx;\n            font-size: 12rpx;\n            border: none;\n            line-height: 25rpx;\n            text-align: center;\n\n\n            &.clear-btn {\n                background: #ff4444;\n                color: #fff;\n            }\n\n            &.undo-btn {\n                background: #ff9500;\n                color: #fff;\n            }\n\n            &.save-btn {\n                background: #07c160;\n                color: #fff;\n            }\n\n            &.cancel-btn {\n                background: #999;\n                color: #fff;\n            }\n        }\n    }\n}\n</style>","import MiniProgramPage from '/Users/yx/Documents/Vue3Projects/cycl/pages/syContract/shSignature.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","onUnload","uni"],"mappings":";;;;;;;;;;;;;;;AA0BA,UAAM,aAAaA,cAAG,IAAC,EAAE;AACzB,UAAM,gBAAgBA,cAAG,IAAC,MAAM;AAGhC,UAAM,WAAWA,cAAG,IAAC,OAAO;AAC5B,UAAM,UAAUA,cAAG,IAAC,CAAC;AACrB,UAAM,aAAaA,cAAG,IAAC,IAAI;AAC3B,UAAM,eAAeA,cAAG,IAAC,IAAI;AAG7BC,kBAAM,OAAC,CAAC,YAAY;AAChB,iBAAW,QAAQ,QAAQ,cAAc;AACzC,oBAAc,QAAQ,QAAQ,SAAS;AAAA,IAC3C,CAAC;AAGDC,kBAAAA,SAAS,MAAM;AAEXC,oBAAAA,MAAA,MAAA,OAAA,0CAAY,QAAQ;AAAA,IACxB,CAAC;AAGD,UAAM,iBAAiB,MAAM;AACzB,UAAI,aAAa,OAAO;AACpB,YAAI;AACA,uBAAa,MAAM,MAAO;AAAA,QAC7B,SAAQ,OAAO;AACZA,wBAAAA,MAAA,MAAA,QAAA,0CAAa,WAAW,KAAK;AAAA,QAChC;AAAA,MACJ;AAAA,IACL;AAGA,UAAM,gBAAgB,MAAM;AACxB,UAAI,aAAa,OAAO;AACpB,YAAI;AACA,uBAAa,MAAM,KAAM;AAAA,QAC5B,SAAQ,OAAO;AACZA,wBAAAA,MAAA,MAAA,QAAA,0CAAa,WAAW,KAAK;AAAA,QAChC;AAAA,MACJ;AAAA,IACL;AAGA,UAAM,gBAAgB,MAAM;AACxB,UAAI,CAAC,aAAa,OAAO;AACrBA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QAClB,CAAS;AACD;AAAA,MACH;AAED,mBAAa,MAAM,qBAAqB;AAAA,QACpC,SAAS,CAAC,QAAQ;AACd,cAAI,IAAI,SAAS;AACbA,0BAAAA,MAAI,UAAU;AAAA,cACV,OAAO;AAAA,cACP,MAAM;AAAA,YAC1B,CAAiB;AACD;AAAA,UACH;AAEDA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACtB,CAAa;AAGD,qBAAW,MAAM;AACbA,0BAAAA,MAAI,aAAa;AAAA,cACb,OAAO;AAAA,cACP,SAAS,MAAM;AAEXA,8BAAG,MAAC,MAAM,oBAAoB;AAAA,kBAC1B,QAAQ,IAAI;AAAA,gBACxC,CAAyB;AAAA,cACJ;AAAA,YACrB,CAAiB;AAAA,UACJ,GAAE,IAAI;AAAA,QACV;AAAA,QACD,MAAM,CAAC,UAAU;AACbA,wBAAAA,MAAA,MAAA,SAAA,2CAAc,WAAW,KAAK;AAC9BA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UACtB,CAAa;AAAA,QACJ;AAAA,MACT,CAAK;AAAA,IACL;AAGA,UAAM,kBAAkB,MAAM;AAC1BA,oBAAAA,MAAI,UAAU;AAAA,QACV,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AACd,cAAI,IAAI,SAAS;AACbA,0BAAAA,MAAI,aAAc;AAAA,UACrB;AAAA,QACJ;AAAA,MACT,CAAK;AAAA,IACL;AAGA,UAAM,OAAO,MAAM;AACfA,oBAAAA,MAAI,aAAc;AAAA,IACtB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpIA,GAAG,WAAW,eAAe;"}